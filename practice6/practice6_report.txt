# Rapport RI - TP6


## Correction apportées à la version 3 :

Correction de l'entrelacement des résultats :
- trie par doc_id et supression des éléments qui englobe d'autres éléments retournés
- puis trie par score décroissant
- ajoute les score par ordre décroissant que si on n'a pas déjà ajouté un élément du
  même document.


On avait aussi des temps de tratement de 30s à 1m par query dans la dernière version
car on avait désactivé le cache des fonctions de weighting afin de ne pas surcharché la RAM.
Mais nous avons réactivé ce cache (de 256Mo pour chaque fonction de calcule intermédiraire
qui sont au nombre de 2 à 4), car les optimisation faites dans la version précédentes on
permis de réseooudre ce problème de RAM et on peut donc se permettre de réactiver le cache.

Maintenant le temps de traitement d'une query est oscille autour de 26s.

Pour donner un ordre de grandeur, le programme affiche une utilisation de 8 900 Mo dans le
gestionnaire des tâches de windows. (sur 16Go)


On a aussi tester de faire des run en prennant en compte une liste réduite de tags xml :
["article", "title", "bdy", "p"], ce qui permet de réduire drastiquement le temps de 
traitement d'une query de 20s à moins de 200ms.


Les statistiques de la collection sont les mêmes que précédements et sont remis ici au besoin

## Quelques chiffres :

- exploration de 3,457,522 xpath dans la collection pour le ranking
- temps moyen du preprocessing : 7min
- temps moyen de l'indexing : 4min (2 min si on utilise une stop-liste)
- taille moyenne des index sauvegardé (avec qq stats) : 3,3Go
- temps de ranking de 26s
- chargement d'un index sauvegarder ~10min (dû à la taille du fichier et au module python 
  (pickle) utilisé, on envisage des alternatives comme hickle ou cPickle)


## Exemple de statistiques pour une de nos collections :


index_nltk_nostop_lem_porter_XML_Only_Ascii_Coll_NoSem.pkl
--------------------------------------------------

  Collection: ../../data/Practice_05_data/XML-Coll-withSem/

  Number of documents: 9805

  Average Document Length: 27.96430392656808 (words)

  Average Term Length: 5.754018202601445 (characters)

  Vocabulary Size: 157870 (unique terms)

  Total Collection Frequency: 2688255 (terms)

  Loading time: 00h02m00s120252ms616100ns (total: 120252616100ns) seconds

  Preprocessing time: 00h06m26s386328ms967800ns (total: 386328967800ns) seconds

  Indexation time: 00h01m58s118548ms39900ns (total: 118548039900ns) seconds

  Total time: 00h06m26s386328ms967800ns (total: 386328967800ns)00h01m58s118548ms39900ns (total: 118548039900ns) seconds

  Computing statistics time: 00h00m02s2352ms751000ns (total: 2352751000ns) seconds

--------------------------------------------------


## Exemple de temps de traitement pour 2 queries avec une liste de tag

Query preprocessed: ['supervis', 'machin', 'learn', 'algorithm']
Computing RSV for 19821 xpath...
Documents ranked in 00h00m00s172ms340200ns (total: 172340200ns)



Query preprocessed: ['oper', 'system', 'mutual', 'exclus']
Computing RSV for 19821 xpath...
Documents ranked in 00h00m00s164ms606700ns (total: 164606700ns)



Saving run file to ../results/MohammedWilliam_266_bm25_article_title_bdy_p_stop671_porter_k3.7_b0.9.txt...
